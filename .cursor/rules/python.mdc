---
description:
globs:
alwaysApply: true
---
# Python Development Standards

## Overview
This document defines the standards and guidelines for Python development in the mus project.

## Code Style
- Use type hints for all function parameters and return values
- Follow PEP 8 style guide consistently
- Use docstrings for all public functions and classes
- Use async/await for all I/O operations
- Use context managers for resource management
- Avoid dynamic attribute access and type checking:
  - Do not use hasattr() for attribute existence checks
  - Do not use getattr() for dynamic attribute access
  - Do not use isinstance() for type checking
  - Instead, use explicit type checking and direct attribute access
  - For optional attributes, handle their absence through proper error handling or default values
- Follow DRY (Don't Repeat Yourself) principles:
  - Extract repeated code into reusable functions or methods
  - Use data structures (e.g., dictionaries, sets) to avoid repetitive conditionals
  - Maintain a single source of truth for configuration and constants
  - Avoid duplicating business logic across different parts of the codebase
  - Use inheritance or composition to share common functionality
  - Consider using design patterns to eliminate code duplication

## Testing Standards
- Write tests for all public functions and classes
- Use pytest fixtures for test setup
- Use pytest-asyncio for async tests
- Maintain test coverage above 80%
- Include both unit and integration tests

## Logging Practices
- Use structlog for all logging
- Include relevant context in log messages
- Use appropriate log levels (debug, info, warning, error)
- Log exceptions with full stack traces
- Structure logs for easy parsing

## Error Handling
- Use custom exceptions for domain-specific errors
- Handle all exceptions at the appropriate level
- Log all errors with context
- Return meaningful error messages to clients
- Document error handling strategies

## Dependency Management
- Use uv for package management
- Pin all dependencies to specific versions
- Document all dependencies in pyproject.toml
- Keep dependencies up to date
- Test after dependency updates
